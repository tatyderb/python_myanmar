# Классы и объекты

lesson = 530841

## Переменные (повторение)

Переменные не нужно объявлять заранее. 

**У переменных нет типа. Тип есть только у данных, на которые указывают переменные**. 

Для опредения типа используют функцию **type()**
```python
x = 5
print(x)         # 5
print(type(x))   # <class 'int'>

x = 3.14
print(x)         # 3.14
print(type(x))   # <class 'float'>

x = 'Hello'
print(x)         # Hello
print(type(x))   # <class 'str'>
```
int, float, str, bool, complex - встроенные типы данных языка. 

Они **unmutable** (неизменяемые). (Только неизменяемые данные могут быть ключами в словаре).

Изменяемые объекты (mutable) - это черепаха, список, словарь.

## Ссылки на объекты

Все переменные содержат только **ссылки на объекты**. Ссылка - это информация **где** лежит объект. Будем рисовать ее стрелкой.

![ссылки и объекты](/assets/reference.png)

* Оператор = связывает переменную с объектом в памяти через ссылку. 
    * Если переменная уже существует, то справа от = напишем ссылку на объект, которая будет храниться в переменной. 
    * Если переменной еще нет, то оператор = создает переменную и записывает в нее ссылку (которая указана справа от =).


Для упрощения рисунков дальше вместо ссылок на неизменяемые объекты будем рисовать переменные со значением.

```python
>>> a = 3
```
1. Создается объект, представляющий число 3 (так как объект неизменяемый, то он создается только если его еще нет, но с логической точки зрения можете считать, что каждый раз создается новый объект).
2. Создается переменная `a`, если ее еще нет.
3. В переменную а записывается ссылка на объект, представляющий число 3. 

```python
t = turtle.Turtle()
```
1. Создается объект, представляющий черепаху.
2. Создается переменная `t`, если ее еще нет.
3. В переменную `t` записывается ссылка на объект черепаха. 

Термины:

* **Переменная** - запись в системной таблице, где предусмотрено место для хранения ссылок на объекты.
* **Объект** - это область памяти с объемом, достаточным для представления значения этого объекта.
* **Ссылка** – это автоматически разыменовываемый указатель на объект (связь переменная - объект).

## id - идентификатор объекта

Чтобы быстро отличать один объект от другого, у каждого объекта есть свой номер.

У разных объектов номера разные (уникальные).

Чтобы узнать идентификационный номер объекта (**идентификатор**), используют встроенную функцию **id(объект)**

* В примере создаем 2 разных списка с одинаковым содержимым. 
* Переменная a ссылается на объект с идентификатором 4292354496.
* Переменная b - на другой список с идентификатором 4292357856.

```python
>>> a = [1, 2, 3]
>>> id(a)
4292354496
>>> b = [1, 2, 3]
>>> id(b)
4292357856
```

## is - ссылаются на один объект

Ключевое слово **is** проверяет, ведут ли ссылки на один и тот же объект. 

То есть `a is b` это `id(a) == id(b)`

```python
>>> a = [1, 2, 3]
>>> id(a)
4292354496
>>> b = [1, 2, 3]
>>> id(b)
4292357856
>>> a is b
False
>>> a == b
True
```

`a = b` - это переменная `a` стала ссылаться на тот же объект, что и переменная `b`

![Нужен рисунок a = b]()

```python
>>> a = b    # теперь a и b ссылаются на один и тот же объект (одинаковые id)
>>> id(a)
4292357856
>>> id(b)
4292357856
>>> a is b
True
```

## Классы

Мы создавали и работали с объектами разных типов. Научимся **создавать новые типы объектов**.

Каждый объект - это данные и что можно делать с этими данными (функции).

* В строке 'Hello' данные - это буквы H, e, l, l, o.
* Что можно делать со строкой? 
    * Найти на каком месте в строке стоит буква 'e' вызвав 'Hello'.index('e'). 
    * Сделать все буквы большими 'Hello'.toupper()

Данные называют **атрибутами (переменными) объекта**, а функции - **методами объекта**.

**Описание данных (переменных) и что с ними можно делать (функций) для разных, но похожих объектов, образует класс**.

Строки 'Hello' и 'Good bye' - два разных объекта класса str. 

## Зачем нужны классы?

В классе удобно хранить всю информацию, которая относится к 1 объекту.

Отрезок на оси Х - это координаты его концов.

Студент - это имя и его оценки по предмету.

Напишем функцию вычисления площади треугольника по координатам его вершин. По формуле Герона 

$$s = \sqrt{p(p-a)(p-b)(p-c)}$$ 

где $a, b, c$ - длины сторон треугольника, $$p = \frac{a + b + c}{2}$$

Напишем функцию `dist(x1, y1, x2, y2)`. Она вычисляет расстояние между точками (x1, y1) и (x2, y2).

```python
def dist(x1, y1, x2, y2):
    dx = x1 - x2
    dy = y1 - y2
    return math.sqrt(dx * dx + dy * dy)
```
Ей пользоваться не очень удобно. Я забываю порядок аргументов. Нужно x1, y1, x2, y2 или x1, x2, y1, y2.

Лучше бы было передать в dist две точки.

## Вычисление площади, слишком много аргументов

Так очень плохо названы аргументы. Можно запутаться где х координаты, где y.

```python
def area(a, b, c, d, e, f):
    s1 = dist(a, b, c, d)
    s2 = dist(a, b, e, f)
    s3 = dist(c, d, e, f)
    p = (s1 + s2 + s3) / 2
    return math.sqrt( p * (p - s1) * (p - s2) * (p - s3))
```

Лучше:
```python
def area(x1, y1, x2, y2, x3, y3):
    a = dist(x1, y1, x2, y2)
    b = dist(x1, y1, x3, y3)
    c = dist(x2, y2, x3, y3)
    p = (a + b + c) / 2
    return math.sqrt( p * (p - a) * (p - b) * (p - c))  # удобно, похоже на формулу
```

Еще лучше (мы научимся так писать):
```python
def dist(p1, p2):
    dx = p1.x - p2.x
    dy = p1.y - p2.y
    return math.sqrt(dx * dx + dy * dy)
    
def area(p1, p2, p3):
    a = dist(p1, p2)
    b = dist(p2, p3)
    c = dist(p3, p2)
    p = (a + b + c) / 2
    return math.sqrt( p * (p - a) * (p - b) * (p - c))  # удобно, похоже на формулу
```

Если треугольников много, их вершин тоже много и можно перепутать точки от разных треугольников. Очень тяжело искать такую ошибку.

С классами будет еще лучше. Точки не перепутаешь:
```python
t = Triangle(p1, p2, p3)
s = area(t)
```
и мы будем вызывать для треугольника функции, как для черепахи или строки:
```python
s = t.area()    # очень хорошо
```